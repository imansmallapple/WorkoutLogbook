import { Sport } from '../model/dailyExercise'
import router from '@ohos.router'
import { SportDetailDialog } from '../Component/SportDetailDialog'

AppStorage.setOrCreate<Sport>("current_sport", new Sport());

@Entry
@Component
struct AddSport {
  @StorageLink("current_sport") current_sport: Sport = new Sport();
  @State num: number = 0
  controller: CustomDialogController = new CustomDialogController({
    builder: SportDetailDialog({
      num:$num
    })
  })
  arr: Sport[] = [
    {
      name: 'Dancing',
      icon: $r('app.media.icon'),
      consume: 450,
      unit: 'hour'
    },
    {
      name: 'Bicycle',
      icon: $r('app.media.icon'),
      consume: 600,
      unit: 'hour'
    },
    {
      name: 'Jogging',
      icon: $r('app.media.icon'),
      consume: 500,
      unit: 'hour'
    },
    {
      name: 'Swimming',
      icon: $r('app.media.icon'),
      consume: 700,
      unit: 'hour'
    },
  ]

  build() {
    Column() {
      Row() {
        Image($r('app.media.icon'))
          .width(25)
      }
      .margin({ top: 10, left: 10, bottom: 10 })
      .onClick(() => {
        router.back()
      })
      Text(`num:${this.num}`)

      List({ space: 10 }) {
        ForEach(this.arr, (item: Sport) => {
          ListItem() {
            Row() {
              Image(item.icon)
                .width(60)
                .height(60)
                .margin({ right: 15 })
              Column() {
                Text(item.name)
                  .fontSize(15)
                  .fontWeight(500)
                Text(item.consume + ' calories/' + item.unit)
                  .fontSize(10)
                  .fontWeight(600)
                  .opacity(0.7)
              }
              .alignItems(HorizontalAlign.Start)

              Blank()
              Button() {
                Image($r('app.media.icon'))
                  .width(20)
              }
              .backgroundColor(Color.Transparent)
              .onClick(() => {
                // todo: Trigger select sport action
                this.current_sport = item
                this.current_sport.num = this.num
                AppStorage.setOrCreate("current_sport", this.current_sport);
                this.controller.open()
              })
            }
            .width('100%')
            .justifyContent(FlexAlign.SpaceBetween)
          }
          .width('95%')
          .backgroundColor(Color.White)
          .padding(5)
        })
      }
      .width('100%')
      .alignListItem(ListItemAlign.Center)
    }
    .width('100%')
    .height('100%')
    .backgroundColor(Color.Gray)
    .alignItems(HorizontalAlign.Start)
  }
}